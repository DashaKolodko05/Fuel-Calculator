package org.example

import kotlin.math.*

fun main() {
    println("=== ПРАКТИЧНА РОБОТА №4 ===")
    println("Виконала: Колодько Дар'я (Варіант 3)")
    println("--------------------------------------------------")

    // ЗАВДАННЯ 1. Вибір кабелю (Приклад 7.1)
    println("\n>>> ЗАВДАННЯ 1: Вибір кабелю (Приклад 7.1)")
    val Sm = 1300.0 // Розрахункове навантаження, кВ*А
    val U_nom = 10.0 // Номінальна напруга, кВ
    val Ik = 2500.0 // Струм КЗ, А
    val tf = 2.5 // Час відключення, с
    
    // 1. Розрахунковий струм для нормального режиму
    // Im = Sm / (2 * sqrt(3) * U_nom) -- ділимо на 2, бо два кабелі (трансформатори)
    // Але у формулі з методички Im = (Sm/2) / (sqrt(3)*U_nom)
    val Im = (Sm / 2.0) / (sqrt(3.0) * U_nom)
    
    // 2. Розрахунковий струм для післяаварійного режиму (один кабель вийшов з ладу)
    val Im_pa = 2 * Im 
    
    // Економічний переріз (для Tм=4000 год, j_ek=1.4)
    val j_ek = 1.4
    val s_ek = Im / j_ek
    
    println("Розрахунковий струм (норм): ${String.format("%.1f", Im)} A")
    println("Розрахунковий струм (післяаварійний): ${String.format("%.1f", Im_pa)} A")
    println("Економічний переріз: ${String.format("%.1f", s_ek)} мм2")
    println("Вибрано кабель: ААБ 10 3х25 (з допустимим струмом I_dop=90 A)") // Приймаємо з методички
    
    // Перевірка на термічну стійкість
    // s_min = Ik * sqrt(tf) / C_t
    // C_t = 92 (для алюмінієвих жил, паперова ізоляція)
    val Ct = 92.0
    val s_min = (Ik * sqrt(tf)) / Ct
    
    println("Мінімальний переріз за термічною стійкістю: ${String.format("%.1f", s_min)} мм2")
    if (s_min > 25) {
        println("РЕЗУЛЬТАТ: Вибраний кабель 25 мм2 НЕ підходить (менше ${String.format("%.1f", s_min)}).")
        println("Необхідно збільшити переріз до 50 мм2.")
    } else {
        println("РЕЗУЛЬТАТ: Кабель підходить.")
    }


    // ЗАВДАННЯ 2. Розрахунок струмів КЗ (Приклад 7.2)
    println("\n--------------------------------------------------")
    println(">>> ЗАВДАННЯ 2: Розрахунок струмів КЗ на шинах 10 кВ (Приклад 7.2)")
    val Sk = 200.0 // Потужність КЗ, МВ*А
    val Uc = 10.5  // Середня напруга, кВ
    val Uk_perc = 10.5 // Напруга КЗ трансформатора, %
    val S_nom_t = 6.3  // Номінальна потужність трансформатора, МВ*А
    
    // Опір системи (X_c)
    val Xc = (Uc * Uc) / Sk
    
    // Опір трансформатора (X_t)
    val Xt = (Uk_perc * Uc * Uc) / (100 * S_nom_t)
    
    // Сумарний опір
    val X_sum = Xc + Xt
    
    // Початковий струм КЗ (Ip0)
    val Ip0 = Uc / (sqrt(3.0) * X_sum)
    
    println("Опір системи (Xc): ${String.format("%.2f", Xc)} Ом")
    println("Опір трансформатора (Xt): ${String.format("%.2f", Xt)} Ом")
    println("Сумарний опір (X_sum): ${String.format("%.2f", X_sum)} Ом")
    println("Початковий струм трифазного КЗ (Ip0): ${String.format("%.2f", Ip0)} кА")


    // ЗАВДАННЯ 3. Розрахунок для підстанції (Приклад 7.4)
    println("\n--------------------------------------------------")
    println(">>> ЗАВДАННЯ 3: Струми КЗ для підстанції ХПнЕМ (Приклад 7.4)")
    // Вхідні дані з прикладу
    val Uk_max = 11.1 // %
    val U_vn = 115.0  // кВ
    val U_nn = 11.0   // кВ
    
    // Дані для нормального режиму (з методички):
    val Rc_n = 10.65
    val Xc_n = 24.02
    val Rc_min = 34.88
    val Xc_min = 65.68
    
    // Розрахунок реактивного опору трансформатора (Xt)
    // Xt = (Uk%/100) * (U_vn^2 / S_nom) -- формула приведена до ВН
    // В прикладі 7.4 розрахунок Xt = (11.1 * 115^2) / (100 * 6.3) = 233 Ом
    // Але в прикладі 7.4 чомусь ділять на 6.3 (потужність ТМН-6300/110 - це 6.3 МВА)
    // Перерахуємо Xt
    val Xt_hv = (11.1 * 115.0 * 115.0) / (100.0 * 6.3)
    
    // Нормальний режим (Z_sum_n)
    val X_sum_n = Xc_n + Xt_hv
    val Z_sum_n = sqrt(Rc_n.pow(2) + X_sum_n.pow(2))
    
    // Мінімальний режим (Z_sum_min)
    val X_sum_min = Xc_min + Xt_hv
    val Z_sum_min = sqrt(Rc_min.pow(2) + X_sum_min.pow(2))
    
    // Струми трифазного КЗ (I3)
    val I3_n = (U_vn * 1000) / (sqrt(3.0) * Z_sum_n)
    val I3_min = (U_vn * 1000) / (sqrt(3.0) * Z_sum_min)
    
    // Струми двофазного КЗ (I2)
    val I2_n = I3_n * (sqrt(3.0) / 2.0)
    val I2_min = I3_min * (sqrt(3.0) / 2.0)
    
    println("Опір трансформатора (Xt): ${String.format("%.2f", Xt_hv)} Ом")
    println("Сумарний опір (Норм. режим): ${String.format("%.2f", Z_sum_n)} Ом")
    println("Сумарний опір (Мін. режим): ${String.format("%.2f", Z_sum_min)} Ом")
    
    println("\nСтруми трифазного КЗ (на шинах 110 кВ):")
    println("Нормальний режим: ${String.format("%.0f", I3_n)} А")
    println("Мінімальний режим: ${String.format("%.0f", I3_min)} А")
    
    println("\nСтруми двофазного КЗ (на шинах 110 кВ):")
    println("Нормальний режим: ${String.format("%.0f", I2_n)} А")
    println("Мінімальний режим: ${String.format("%.0f", I2_min)} А")
}
